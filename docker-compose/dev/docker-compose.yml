version: "3.8"

services:
    configserver:
        image: sachinsan2131/configserver
#        mem_limit: 500m
        ports:
            - "8071:8071"
        networks:
            - ms-network

    accounts:
        image: sachinsan2131/accounts
#        mem_limit: 500m
        ports:
            - "8080:8080"
        depends_on:
            - configserver
        deploy:
            restart_policy:
                condition: on-failure
                delay: 5s
                max_attempts: 3
                window: 120s
        environment:
            SPRING_PROFILES_ACTIVE: dev
            SPRING_CONFIG_IMPORT: configserver:http://configserver:8071
        networks:
            - ms-network
    loans:
        image: sachinsan2131/loans
#        mem_limit: 500m
        ports:
            - "8080:8080"
        depends_on:
            - configserver
        deploy:
            restart_policy:
                condition: on-failure
                delay: 5s
                max_attempts: 3
                window: 120s
        environment:
            SPRING_PROFILES_ACTIVE: dev
            SPRING_CONFIG_IMPORT: configserver:http://configserver:8071
        networks:
            - ms-network
    cards:
        image: sachinsan2131/cards
 #       mem_limit: 500m
        ports:
            - "8080:8080"
        depends_on:
            - configserver
        deploy:
            restart_policy:
                condition: on-failure
                delay: 5s
                max_attempts: 3
                window: 120s
        environment:
            SPRING_PROFILES_ACTIVE: dev
            SPRING_CONFIG_IMPORT: configserver:http://configserver:8071
        networks:
            - ms-network
networks:
    ms-network: